# EPUB格式轉換器使用指南

## 快速開始

### 1. 啟動應用程式

最簡單的方法是使用提供的啟動腳本：

```bash
./run.sh
```

這個腳本會自動處理所有設定，包括：
- 創建虛擬環境
- 安裝依賴套件
- 啟動GUI應用程式

### 2. 使用GUI介面

當應用程式啟動後，您會看到一個圖形化介面，包含以下區域：

#### 檔案選擇區域
- 點擊「瀏覽...」按鈕選擇要轉換的EPUB檔案
- 支援的檔案格式：`.epub`
- 檔案資訊會顯示在下方

#### 輸出設定區域
- **格式選擇**：
  - `EPUB`：修改後的EPUB檔案（總是可用）
  - `MOBI`：Kindle格式（需要Calibre）
  - `PDF`：PDF格式（需要Calibre）
- **輸出目錄**：點擊「瀏覽...」選擇儲存位置

#### 轉換按鈕
- 點擊「開始轉換」執行轉換
- 轉換過程中可以點擊「取消」停止

#### 進度顯示
- 顯示當前轉換狀態
- 進度條顯示轉換進度

## 轉換流程

### 步驟1：載入EPUB檔案
應用程式會讀取並解析EPUB檔案結構。

### 步驟2：修改閱讀方向和字型
- 將CSS中的`writing-mode`從`vertical-rl`改為`horizontal-tb`
- 將`direction`從`rtl`改為`ltr`
- 設定字型為微軟正黑體
- 添加全域CSS樣式覆蓋

### 步驟3：修改OPF檔案
- 設定`page-progression-direction="ltr"`
- 確保Kindle翻頁方向正確

### 步驟4：格式轉換（如需要）
- 如果選擇MOBI或PDF格式，使用Calibre進行轉換
- 保持修改後的樣式設定

## 測試功能

### 創建測試檔案

```bash
python create_test_epub.py
```

這會創建一個名為`test_vertical_book.epub`的測試檔案，包含：
- 直向閱讀的CSS樣式
- 中文測試內容
- 多個章節

### 轉換測試檔案

1. 啟動應用程式
2. 選擇`test_vertical_book.epub`
3. 選擇輸出格式和位置
4. 執行轉換
5. 檢查轉換結果

## 驗證轉換效果

### 檢查EPUB檔案
1. 使用EPUB閱讀器開啟轉換後的檔案
2. 確認文字方向為橫向（左到右）
3. 確認字型為微軟正黑體
4. 檢查排版是否正確

### 檢查Kindle相容性
1. 將MOBI檔案傳送到Kindle
2. 確認翻頁方向：左側上一頁，右側下一頁
3. 檢查字型顯示效果

## 常見使用情境

### 情境1：轉換日文/中文直向小說
- 適用於傳統直向排版的電子書
- 轉換為現代橫向閱讀格式
- 提升閱讀體驗

### 情境2：Kindle閱讀優化
- 將EPUB轉換為MOBI格式
- 確保正確的翻頁方向
- 優化字型顯示

### 情境3：PDF格式輸出
- 需要固定排版的場合
- 列印或分享用途
- 保持轉換後的格式

## 注意事項

### 檔案備份
- 轉換前請備份原始EPUB檔案
- 轉換是不可逆的過程

### 格式相容性
- 某些複雜的EPUB檔案可能需要手動調整
- 建議先用簡單檔案測試

### 字型支援
- 微軟正黑體在不同系統上可能有不同名稱
- 程式會自動使用備用字型

### 效能考量
- 大型EPUB檔案轉換時間較長
- 建議關閉其他耗資源的應用程式

## 故障排除

如果遇到問題，請參考README.md中的故障排除章節，或檢查：

1. 終端機輸出的錯誤訊息
2. EPUB檔案是否有效
3. 系統權限設定
4. Calibre安裝狀態（如需要）

## 技術支援

如果您遇到技術問題，請提供：
- 錯誤訊息截圖
- 原始EPUB檔案資訊
- 系統環境資訊
- 操作步驟描述
